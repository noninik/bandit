<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent Army</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚡</text></svg>">
</head>
<body>
    <div class="app">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> AGENTS</div>
                <div id="agentsList"></div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> MODE</div>
                <div class="mode-toggle">
                    <label class="toggle-label">
                        <input type="checkbox" id="autoRoute" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-text">🧠 Auto-routing</span>
                    </label>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> 🚀 GENERATE</div>
                <div class="fullcycle-panel">
                    <input type="text" id="nicheInput" placeholder="Введи нишу..." class="niche-input">
                    <button class="fullcycle-btn" onclick="runFullCycle()">
                        🚀 Полный цикл
                        <span class="fullcycle-desc">Скан → Идеи → План</span>
                    </button>
                    <button class="generate-btn" onclick="quickGenerate()">
                        ⚡ Быстрая генерация
                    </button>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> CHAINS</div>
                <div class="chain-buttons">
                    <button class="chain-btn" onclick="runChain(['scanner','idea_generator','business_plan'], 'Полный')">🔥 Скан → Идеи → План</button>
                    <button class="chain-btn" onclick="runChain(['researcher','strategist','marketer'], 'Стратегия')">📊 Анализ → Стратегия</button>
                    <button class="chain-btn" onclick="runChain(['strategist','developer'], 'Тех')">🛠 Стратегия → MVP</button>
                    <button class="chain-btn" onclick="runChain(['marketer','sales'], 'Продажи')">💰 Маркетинг → Продажи</button>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> COMMANDS</div>
                <div id="commandsList"></div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> SESSION</div>
                <div class="session-info">
                    <div class="session-row"><span>📊</span><span>messages: <span id="msgCount">0</span></span></div>
                    <div class="session-row"><span>🤖</span><span>agents: <span id="agentsUsed">0</span></span></div>
                    <div class="session-row"><span>📋</span><span>plans: <span id="plansCount">0</span></span></div>
                    <div class="session-row"><span>🕐</span><span>uptime: <span id="uptime">00:00</span></span></div>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title"><span class="folder-icon">▼</span> QUESTS</div>
                <div id="questsList">
                    <div class="quest-item"><div class="quest-check" id="q1">☐</div><span>Сканировать</span></div>
                    <div class="quest-item"><div class="quest-check" id="q2">☐</div><span>Полный цикл</span></div>
                    <div class="quest-item"><div class="quest-check" id="q3">☐</div><span>Бизнес-план</span></div>
                    <div class="quest-item"><div class="quest-check" id="q4">☐</div><span>3+ агентов</span></div>
                    <div class="quest-item"><div class="quest-check" id="q5">☐</div><span>Дебаты</span></div>
                    <div class="quest-item"><div class="quest-check" id="q6">☐</div><span>Сравнение</span></div>
                    <div class="quest-item"><div class="quest-check" id="q7">☐</div><span>Экспорт</span></div>
                </div>
            </div>

            <div class="sidebar-footer">
                <button class="sidebar-btn" onclick="exportChat()">📥 Export</button>
                <button class="sidebar-btn danger" onclick="resetChat()">🗑 Clear</button>
            </div>
        </aside>

        <button class="mobile-toggle" onclick="toggleSidebar()">☰</button>

        <!-- Main -->
        <main class="main-content">
            <!-- Tabs -->
            <div class="tab-bar">
                <div class="tab-group">
                    <div class="tab active" onclick="showPanel('all')"><span class="tab-icon">⚡</span> ALL</div>
                    <div class="tab" onclick="showPanel('dash')"><span class="tab-icon">📊</span> DASH</div>
                    <div class="tab" onclick="showPanel('rank')"><span class="tab-icon">🏆</span> RANK</div>
                    <div class="tab" onclick="showPanel('board')"><span class="tab-icon">📋</span> BOARD</div>
                    <div class="tab" onclick="showPanel('plans')"><span class="tab-icon">💡</span> IDEAS</div>
                    <div class="tab" onclick="showPanel('terminal')"><span class="tab-icon">💬</span> CHAT</div>
                </div>
                <div class="tab-status">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">Ready</span>
                </div>
            </div>

            <!-- Panels Container -->
            <div class="panels-container" id="panelsContainer">

                <!-- Dashboard Panel -->
                <div class="panel" id="dashPanel" style="display:none">
                    <div class="dash-grid">
                        <div class="dash-card">
                            <div class="dash-card-title">💡 Всего идей</div>
                            <div class="dash-card-value" id="dashTotalIdeas">0</div>
                        </div>
                        <div class="dash-card">
                            <div class="dash-card-title">⭐ Средний рейтинг</div>
                            <div class="dash-card-value" id="dashAvgRating">0</div>
                        </div>
                        <div class="dash-card">
                            <div class="dash-card-title">💬 Сообщений</div>
                            <div class="dash-card-value" id="dashMessages">0</div>
                        </div>
                        <div class="dash-card">
                            <div class="dash-card-title">🤖 Агентов</div>
                            <div class="dash-card-value" id="dashAgents">0</div>
                        </div>
                    </div>
                    <div class="dash-section">
                        <h3>📊 Ниши по популярности</h3>
                        <div class="dash-bars" id="dashNicheBars"></div>
                    </div>
                    <div class="dash-section">
                        <h3>📦 Форматы продуктов</h3>
                        <div class="dash-bars" id="dashFormatBars"></div>
                    </div>
                    <div class="dash-section">
                        <h3>🏆 Топ-5 идей</h3>
                        <div class="dash-top-list" id="dashTopList"></div>
                    </div>
                </div>

                <!-- Rank Panel -->
                <div class="panel" id="rankPanel" style="display:none">
                    <div class="rank-header">
                        <h3>🏆 Рейтинг ниш</h3>
                        <button class="rank-refresh" onclick="loadRankings()">🔄</button>
                    </div>
                    <div class="rank-table" id="rankTable">
                        <div class="rank-empty">Генерируй идеи чтобы заполнить рейтинг</div>
                    </div>
                </div>

                <!-- Board Panel (Kanban) -->
                <div class="panel" id="boardPanel" style="display:none">
                    <div class="kanban">
                        <div class="kanban-col">
                            <div class="kanban-col-header idea-col">💡 Идеи</div>
                            <div class="kanban-list" id="kanbanIdeas"></div>
                        </div>
                        <div class="kanban-col">
                            <div class="kanban-col-header research-col">🔍 Исследование</div>
                            <div class="kanban-list" id="kanbanResearch"></div>
                        </div>
                        <div class="kanban-col">
                            <div class="kanban-col-header mvp-col">🛠 MVP</div>
                            <div class="kanban-list" id="kanbanMvp"></div>
                        </div>
                        <div class="kanban-col">
                            <div class="kanban-col-header launch-col">🚀 Запуск</div>
                            <div class="kanban-list" id="kanbanLaunch"></div>
                        </div>
                        <div class="kanban-col">
                            <div class="kanban-col-header money-col">💰 Доход</div>
                            <div class="kanban-list" id="kanbanMoney"></div>
                        </div>
                    </div>
                </div>

                <!-- Split: Ideas + Terminal -->
                <div class="split-screen" id="splitScreen">
                    <!-- Ideas -->
                    <div class="plans-panel" id="plansPanel">
                        <div class="plans-header">
                            <h3>💡 Бизнес-идеи</h3>
                            <div class="plans-header-actions">
                                <button onclick="refreshIdeas()" class="plans-refresh-btn">🔄</button>
                                <button onclick="compareSelected()" class="plans-compare-btn" id="compareBtn" style="display:none">⚖️ Сравнить</button>
                                <span class="plans-count" id="plansCardCount">0</span>
                            </div>
                        </div>
                        <div class="plans-list" id="plansList">
                            <div class="plans-empty" id="plansEmpty">
                                <div class="empty-icon">💡</div>
                                <p>Генерация идей...</p>
                            </div>
                        </div>
                    </div>

                    <div class="panel-divider" id="panelDivider"></div>

                    <!-- Terminal -->
                    <div class="terminal-panel" id="terminalPanel">
                        <div class="terminal" id="terminal">
                            <div class="terminal-welcome">
                                <pre class="ascii-art">
 ╔═══════════════════════════════════════════╗
 ║     AI  AGENT  ARMY  v6.0                ║
 ║     Debates + Dashboard + Kanban          ║
 ╚═══════════════════════════════════════════╝</pre>
                                <div class="init-log"><span class="log-success">✓</span> System online</div>
                                <div class="init-log"><span class="log-success">✓</span> 10 agents loaded (+ Debater, Comparator)</div>
                                <div class="init-log"><span class="log-success">✓</span> Dashboard ready</div>
                                <div class="init-log"><span class="log-success">✓</span> Kanban board ready</div>
                                <div class="init-log"><span class="log-info">ℹ</span> New: 🗣 /debate — agents discuss your idea</div>
                                <div class="init-log"><span class="log-info">ℹ</span> New: ⚖️ Select cards → Compare</div>
                                <div class="init-log"><span class="log-info">ℹ</span> New: 📊 DASH tab — analytics</div>
                                <div class="init-log"><span class="log-info">ℹ</span> New: 📋 BOARD tab — kanban tracker</div>
                            </div>
                        </div>

                        <div class="input-bar">
                            <div class="input-prompt">
                                <span class="prompt-agent" id="promptAgent">🧠</span>
                                <span class="prompt-arrow">❯</span>
                            </div>
                            <textarea id="userInput" placeholder="Task or /command..." rows="1" onkeydown="handleKeyDown(event)" spellcheck="false"></textarea>
                            <button onclick="sendMessage()" id="sendBtn">▶</button>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>
